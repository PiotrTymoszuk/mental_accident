---
title: "Three distinct patterns of mental health response following accidents in mountain sports – a follow-up study of individuals treated at a tertiary trauma center"
subtitle: "Supplementary Material"
author: "Psychiatry Study Team"
date: "`r format(Sys.time(), '%Y-%m-%d')`"

output: 
  bookdown::word_document2:   
    reference_docx: ms_template.docx
    
bibliography: ptsd_biblio.bib
csl: frontiers_medical.csl

header-includes:
  \usepackage{longtable}
  \usepackage{tabu}
  \usepackage{caption}
  \usepackage{makecell}
  \usepackage{pdflscape}
  \usepackage{array}
  \usepackage{booktabs}
  \usepackage{threeparttable}
  \usepackage{threeparttablex}
  \usepackage{wrapfig}
  \usepackage{multirow}
  \usepackage[normalem]{ulem}
  \usepackage{colortbl}
  \usepackage{xcolor}
  \usepackage{float} \floatplacement{figure}{H} \floatplacement{table}{H}
  \newcommand{\beginsupplement}{\setcounter{table}{0}  \renewcommand{\thetable}{S\arabic{table}}       \setcounter{figure}{0} \renewcommand{\thefigure}{S\arabic{figure}}}
---

```{r, setup, include = FALSE}

knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE, 
                      message = FALSE, 
                      dev = "png", 
                      dpi = 600, 
                      tab.cap.pre = 'Supplementary Table ', 
                      tab.cap.sep = " ", 
                      tab.cap.style = 'Table Heading')

set_flextable_defaults(font.family = 'Cambria', font.size = 9)


```

\newpage

# Supplementary Methods

## Software

Data analysis and transformation was accomplished with R version 4.2.3. 
The study data set was imported from an SPSS file with the _foreign_ package [@RCoreTeam]. 
Tabular data were handled with the _tidyverse_ package bundle [@Wickham2019], and the packages _rlang_ [@Henry2022] and [_trafo_](https://github.com/PiotrTymoszuk/trafo). 
Text variables were handled with _stringi_ [@Gagolewski2021]. 
Imputation of missing values of psychometric variables was done with the package _impute_ [@Hastie2023].

For distribution testing (normality, variance, Gini index), the packages [_ExDA_](https://github.com/PiotrTymoszuk/ExDA), _rstatix_ [@Kassambara2021] and _DescTools_ [@Signorell2022] were utilized. 
Consistency of psychometric tools was assessed with the packages _psych_ [@Revelle2022], [_ExDA_](https://github.com/PiotrTymoszuk/ExDA) and [_clustTools_](https://github.com/PiotrTymoszuk/clustTools). 
Clustering tendency was investigated with _factoextra_ [@Kassambara2020] and [_clustTools_](https://github.com/PiotrTymoszuk/clustTools). 
Statistical hypothesis testing and correlation analyses were accomplished with [_ExDA_](https://github.com/PiotrTymoszuk/ExDA) and _rstatix_ [@Kassambara2021]. 
Bootstrapped estimates of prevalence of mental disorder symptoms and traumatic events with their 95% confidence intervals were computed with the development package [_bootStat_](https://github.com/PiotrTymoszuk/bootStat).

For semi-supervised clustering, diagnostic and performance testing of the clustering analysis, the package [_clustTools_](https://github.com/PiotrTymoszuk/clustTools) with implementation of algorithms and distance measures from _factoextra_, _cluster_ and _philentropy_ [@Schubert2019; @Drost2018; @Kassambara2020] was utilized. 
UMAP (uniform manifold approximation and projection) was done with the _umap_ and [_clustTools_](https://github.com/PiotrTymoszuk/clustTools) packages [@Konopka2022; @McInnes2018]. 
Cross-distances between the training and test subsets of the study cohort and cross-distances between clusters in the training and test subsets of the study cohort were computed with _philentropy_ [@Drost2018] and [_clustTools_](https://github.com/PiotrTymoszuk/clustTools).

Multi-variable classifiers of cluster assignment were developed with the following algorithms: 
random forests [@Breiman2001; @Wright2017], 
neural network [@Ripley2014], 
support vector machines with radial kernel [@Weston1998; @Karatzoglou2004], 
recursive partitioning [@Therneau2022; @Breiman2017], 
conditional random forests [@Hothorn2006; @Strobl2007; @Hothorn2022], 
shrinkage discriminant analysis [@Ahdesmaki2010; @Ahdesmaki2022], 
and elastic net multinomial regression [@Zou2005; @Friedman2010]. 
For tuning, training, prediction and assessment of performance of the classifiers, the packages _caret_ [@Kuhn2008] and [_caretExtra_](https://github.com/PiotrTymoszuk/caretExtra) were used.

Results were visualized with _ggplot_ (bar plots, box plots, heat maps of cross-distances, scatter plots) [@Wickham2016], _plotroc_ [@Sachs2017], [_ExDA_](https://github.com/PiotrTymoszuk/ExDA) (violin, stack and ribbon plots) and [_clustTools_](https://github.com/PiotrTymoszuk/clustTools) (cluster quality control plots, heat maps of clustering features, distance heat maps, scatter plots of UMAP layouts) and _ComplexUpset_ (visualization of overlap with upset plots) [@Krassowski2021]. 
Figures were created with the packages _cowplot_ [@Wilke2019] and _patchwork_ [@Pedersen2023]. 
Tables were generated with _flextable_ [@Gohel2022]. 
The manuscript and Supplementary Material were written in the _rmarkdown_ environment [@Allaire2022] with the package _bookdown_ [@Xie2016]. 
Figures, tables and R expressions in the markdown documents were managed with the development package [_figur_](https://github.com/PiotrTymoszuk/figur). 
The markdown documents were rendered with the _knitr_ [@Xie2022] and _bookdown_ [@Xie2016] packages and with [`author-info-blocks.lua`](https://github.com/pandoc/lua-filters/blob/master/author-info-blocks/author-info-blocks.lua) and [`scholarly-metadata.lua`](https://github.com/pandoc/lua-filters/blob/master/scholarly-metadata/scholarly-metadata.lua) scripts by Albert Krewinkel and Jörn Krenzer.

## Data import and transformation

The study data set was imported from an SPSS file with raw study data (function `read.spss()`, package _foreign_). 
The list of extracted variables with their description is available in __Supplementary Table S\@ref(tab:tab-analysis-vars)__. 
A total of `r nrow(ptsd$dataset)` participants with the complete set of psychometric battery variables (__Supplementary Table S\@ref(tab:tab-mental-battery)__) were included in the analysis (__Figure 1__).

The psychometric battery (__Supplementary Table S\@ref(tab:tab-mental-battery)__) consisted of German versions of assessment tools for 
anxiety (GAD-7: 7-item general anxiety disorder scale) [@Spitzer2006], 
depression (PHQ: patient health questionnaire, PHQ-9 and PHQ-8) [@Lowe2002; @Grafe2004; @Kroenke2002a], 
panic (PHQ-panic module) [@Lowe2002; @Grafe2004], 
common persistent somatic symptoms as a substitute for somatization (PHQ-15) [@Kroenke2002], 
resilience (RS13: 13-item resilience scale) [@Leppert2008], 
loss of sense of coherence (SOC-9L: Leipzig 9-item sense of coherence questionnaire) [@Schumacher2000], 
quality of life (EUROHIS-QOL 8: 8-item EUROHIS project quality of life scale) [@Schmidt2006], 
post-traumatic growth (PTGI: post-traumatic growth inventory) [@Tedeschi1996] and 
post-traumatic stress disorder (PCL-5: PTSD checklist for DSM-5) [@Bovin2016]. 
In the study survey, items of the PTGI and PTSD instruments, and questions concerning flashbacks were provided with a captions indicating that the questions refer to the mountain sport accident of interest ('The following questions refer to consequences of your accident'). 

Clinically relevant symptoms of anxiety were defined as GAD-7 $\geq$ 10, 
clinically relevant symptoms of depression were defined as PHQ-9 $\geq$ 10 [@Humer2022], 
significant persistent somatic symptoms were defined as PHQ-15 $\geq$ 10 [@Kroenke2002]. 
Resilience classes were defined as follows: low: RS-13 0 - 65, moderate: 66 - 72, high: $\geq$ 73 [@Leppert2008]. 
For a comparison of frequency and severity of depressive symptoms in the study cohort with microcensus data for the general Austrian population, mild depressive symptoms were defined as 5 - 9, moderate symptoms as 10 - 14, moderately severe symptoms as 15 - 19, and severe symptoms as $\geq$ 20 points of the PHQ-8 score [@Kroenke2002a].

Items of the EUROHIS QOL 8 tool were scored as with 1 - 5 Likert scales (1: extreme concerns, no satisfaction at all, 5: no concerns/full satisfaction) with each item representing a single domain of quality of life (quality of life, health, energy, finances, activity, self-esteem, relationship and housing). 
The total EUROHIS QOL score was defined as the arithmetic mean of all items [@Schmidt2006]. 

Separate scores were computed for each domain of the PTGI tool (I: relations, II: possibilities, III: personal strength, IV: spiritual strength, V: life appreciation) with each item scores as 0: none, 1: very little, 2: little, 3: moderate, 4: great, 5: extremely great. 
In addition, the total PTGI score was calculated as the sum of all items [@Tedeschi1996]. 

Separate scores were calculated for domains B, C, D and E of the PCL-5 tool along with the total score being the sum of all items. 
Each PCL-5 item was scored as 0: not at all, 1: a little bit, 2: moderate, 3: quite a bit and 4: extremely. 
Participants positive for the B domain or C domain PTSD symptoms were identified by at least one item per domain scored with 'moderate' or higher. 
Participants positive for the D or E domain PTSD symptoms were identified by at least two items per domain scored with 'moderate' or higher. 
Significant PTSD symptoms where assumed in participants screened positive for at least one of the B, C, D or E PCL-5 domains. 
Manifest PTSD was considered for participants positive for all four PCL-5 domains [@Bovin2016]. 

Traumatic events prior to the mountain sport accident were assessed with the DIA-X tool (Diagnostic Expert System) [@Maercker2005]. 
Direct personal experience or being a witness of a traumatic event specified by the DIA-X questionnaire or by an additional yes/no item ('other traumatic events') was scored as 1. 
Prior traumatic event was assumed with at least one DIA-X item scored with 1. 
Pre-existing mental disorder diagnosed by a physician, 
prior mountain sport accidents, 
flashbacks of the surveyed accident during mountain sport activity, 
confusion during mountain sport activity, 
self-reported need for psychological support following the accident, 
psychological/psychiatric support/therapy after the accident 
and presence of persistent physical health consequences related to the accident 
were surveyed as single yes/no items. 
Flashbacks frequency during mountain sport activity was assessed in the following categories: none, more than one per year and more than one per month. 
Smoking was surveyed as a single yes/no question. 
Alcohol use was investigated with the CAGE tool with $\geq$ 2 points indicative of problematic alcohol consumption [@OBrien2008]. 
Data on the type of the accident date and daytime, accident mountain sport, injury diagnosis, injured body regions, injury severity, hospital treatment, surgery and number of ICD-10 surgical diagnoses  were extracted from electronic patient's records. 
Injury severity was assessed with the abbreviated injury scale (AIS) [@Gennarelli2006]. 

Accident sport types were classified in accordance with the annual accident report of the Austrian Board of Mountain Safety [@OsterreichischesKuratoriumfurAlpineSicherheit2024] as follows: 
_alpine skiing/snowboarding_ (all types of alpine ski and snowboard sports in secured areas of ski resorts: pistes, secured slopes, lifts and cable cars), 
_ski touring/freeride_ (all types of alpine ski and snowboard sports performed in non-secured areas of ski reports, e.g. ski touring, freeride), 
_cross-country skiing_, 
_sledding_ (all types of sledding sports such as sledding and bob-sledding), 
_ice climbing_ (ice and mixed climbing in the winter season), 
_hiking_, 
_climbing_ (sport and rock climbing, bouldering), 
_mountaineering_ (high mountain and glacier tours), 
_biking_ (all types of biking including road, cross-country and mountain biking), 
_air sport_ (only paragliding present in our cohort), 
_water sport_, and 
_other_ (non-classifiable sport types such as ski jumping). 
Alpine skiing/snowboarding, ski touring/freeride, cross-country skiing, sledding, and ice climbing were classified as winter sports. 
Hiking, climbing, mountaineering, biking, air sport, and water sport were classified as summer sports. 
Additional information on study variables and their stratification schemes are presented in __Supplementary Table S\@ref(tab:tab-analysis-vars)__.

Information on 
genders ($\geq$ 18 years, in 2023) [@StatistikAustria2023], 
age ($\geq$ 18 years, in 2023) [@StatistikAustria2023], 
education (15 - 64 years old, in 2020) [@StatistikAustria2020]
and employment structure ($\geq$ 15 years, in 2021) [@StatistikAustria2021], 
smoking status ($\geq$ 15 years, in 2019) [@StatistikAustria2019], 
and self-reported chronic physical or mental illness ($\geq$ 15 years, in 2019) [@StatistikAustria2019a] 
for the Austrian population were extracted from publications of Statistik Austria, the national statistical bureau.

Counts of mountain accident victims in 2023 in Austria stratified by mountain sport type, age class and month of the accident were extracted from the annual report of the Austrian Board of Mountain Safety [@OsterreichischesKuratoriumfurAlpineSicherheit2024]. 
Of note, we were not able to consistently eliminate deaths (n = 266), accidents with tourists from non-German-speaking countries, non-adult victims (nation-wide, $\geq$ 20 years old: n = `r 496 + 2074`) and non-sportive accidents (n = 648) from this published nation-wide data set. 
Yet these subsets of mountain accident victims constituted a minority of all nation-wide mountain accidents in 2023 (n = 13681). 

Lifetime estimates of prevalence of traumatic events and PTSD in the general population were obtained from representative survey studies [@Hauffa2011; @Darves-Bornoz2008; @Kilpatrick2013; @Koenen2017; @Kessler2017]. 
Frequency of traumatic events, manifest PTSD and PTSD symptoms subsumed under the B, C, D, and E domains of the PCL-5 instrument in Swiss mountain rescuers were extracted from the report by Mikutta et al. [@Mikutta2022]. 
Data on frequency of clinically relevant anxious (GAD-7 $\geq$ 10) and depressive (PHQ-9 $\geq$ 10) symptoms in Austria in 2022 were obtained from a publication by Humer et al. [@Humer2022]. 
Mean scores of resilient comping with their standard deviations (SD) obtained with the RS-13 tool were extracted from reports with samples of the German [@Leppert2008] and Tyrolean [@Chernova2021] populations, and from a cohort of Swiss mountain rescuers [@Mikutta2022]. 

## Consistency of psychometric tools and power analysis

Consistency of psychometric tools was assessed by factor analysis and McDonald's $\omega$ (function `omega()`, package _psych_) [@McDonald1999; @Revelle2022]. 
The number of latent factors for calculation of $\omega$ was identified by inspection of loadings determined by factor analysis (function `reduce_data()`, [_clustTools_](https://github.com/PiotrTymoszuk/clustTools)) [@Bartlett1937]. 
All psychometric tools used in the study except for the stress PSS-4 scale [@Cohen1983] and the BRCS resilience tool [@Sinclair2004] exhibited good-to-excellent consistency with $\omega$ > 0.8 (__Supplementary Table S\@ref(tab:tab-consistency)__). 
The poorly performing PSS-4 and BRCS scales were excluded from the further analysis.

To find the optimal size of a training subset of the study cohort, random subsamples of the study data set of varying sizes were investigated (`r paste(pow$sizes, collapse = ', ')` observations, 50 random draws per subsample size). 
For each random subsample, clustering tendency was assessed by Hopkins statistic (function `get_clust_tendency()`, package [_clustTools_](https://github.com/PiotrTymoszuk/clustTools)) [@Hopkins1954]. 
For n = 250 observations, the median Hopkins statistic was 
`r pow$hopkins %>% filter(size == 250) %>% .$hopkins_stat %>% median %>% signif(2)` (interquartile range: 
`r pow$hopkins %>% filter(size == 250) %>% .$hopkins_stat %>% quantile(probs = c(0.25, 0.75)) %>% signif(2) %>% paste(collapse = ' - ')`) indicative of good clustering tendency. 
The Hopkins statistic value for this subset was comparable with the value for the entire subset 
(`r signif(pca$clust_tendency$data$hopkins_stat, 2)`). 
For these reasons, 3/4 of the entire data set or n = 
`r count(ptsd$dataset, partition)$n[1]` was considered as the adequate size of the training subset of the study cohort for a reproducible clustering analysis.

## Training/test subset definition

The study participants were assigned to the training and test subsets with the 3:1 size ratio (__Figure 1__). 
To this end, `r nrow(part$dists)` random splits of the data sets were generated. 
The subset assignment scheme was chosen with the possibly smallest differences in sociodemographic, medical history, clinical and accident- and injury-related variables assessed by Gower distance between the training and test subsets (function `dist()`, package _proxy_) [@Meyer2022].

## Statistical hypothesis testing, effect size and multiple testing correction

Differences in numeric variables were assessed with Mann-Whitney test with r effect size statistic or Kruskal-Wallis test with $\eta^2$ effect size statistic for two and more than two analysis groups, respectively. 
Differences in frequency of categories of qualitative variables between analysis groups were investigated with $\chi^2$ test with Cramer's V effect size statistic. 
P values were corrected for multiple testing with the false discovery rate method separately for each analysis task (e.g. comparison of clusters) [@Benjamini1995]. 
Effects with p < 0.05 following the false discovery rate adjustment were considered significant. 
Effect size of accuracy of predicted cluster assignment by machine learning classifiers was assessed by Cohen's $\kappa$ inter-rater reliability statistic [@Cohen1960; @McHugh2012]. 
Intervals of effect sizes were defined as follows [@McHugh2012; @Field2013; @Cohen2013]:

* r statistic: small: < 0.3, moderate: 0.3 - 0.5, large: $\geq$ 0.5

* Cramer's V statistic: small: < 0.3, moderate: 0.3 - 0.5, large: $\geq$ 0.5

* $\eta^2$ statistic: small: < 0.06, moderate: 0.06 - 0.14, large: $\geq$ 0.14

* Cohen's $\kappa$ inter-rater reliability statistic: none: < 0.2, minimal: 0.2 - 0.4, small: 0.4 - 0.6, moderate: 0.6 - 0.8, large: $\geq$ 0.8

## Assessment of selection bias

To assess the possible selection bias, demographic, socioeconomic, clinical, accident- and recovery-related parameters were compared between individuals excluded due to missingness of psychometric data or denying survey participation and participants included in the analysis (__Figure 1__). 
Categorical variables were compared by $\chi^2$ test with Cramer V effect size statistic and numeric variables were compared by Mann-Whitney test with r effect size statistic 
(function `compare_variables()`, package [_ExDA_](https://github.com/PiotrTymoszuk/ExDA)). 
Potential differences between the training and test subset of the study cohort (__Figure 1__) were analyzed in an analogical way. 
Significant (p < 0.05) differences between the included/excluded participants are presented in __Supplementary Table S\@ref(tab:tab-no-response)__ and __S\@ref(tab:tab-missing)__.

## Comparison of socioeconomic, accident and mental health features with population estimates and literature reports

Differences in age, gender, education, professional activity, and frequency of chronic physical and mental disorders between the study cohort and the Austrian population [@StatistikAustria2023; @StatistikAustria2023; @StatistikAustria2020; @StatistikAustria2021; @StatistikAustria2019] were investigated by Mann-Whitney U test with r effect size statistic (age as a numeric variable) or $\chi^2$ test with Cramer's V effect size statistic (remaining categorical variables). 
Global differences in distribution of mountain sport types, age and accident months between the analyzed cohort and the nation-wide collective of Austrian mountain accident victims [@OsterreichischesKuratoriumfurAlpineSicherheit2024] were compared with $\chi^2$ test with Cramer's V effect size statistic. 
In the comparison of sport types, nation-wide counts of non-sportive mountain accidents (e.g. during forestry or hunting) were excluded. 
In the comparison of age distributions, only individuals older than 20 years were included. 
Post-hoc comparisons of the study cohort and nation-wide Austrian counts were done with Holm-corrected $\chi^2$ test. 
The statistical hypothesis testing was done with the function `compare_variables()` from the [_ExDA_](https://github.com/PiotrTymoszuk/ExDA) package. 
The comparison results are presented in __Supplementary Table S\@ref(tab:tab-aut-population)__ and __Supplementary Figure S\@ref(fig:fig-accident)__.

Frequency of traumatic events, manifest PTSD and PTSD symptoms in the current cohort was compared with original reports providing estimates of frequency of traumatic events and PTSD in the general population [@Hauffa2011; @Darves-Bornoz2008; @Kilpatrick2013; @Koenen2017; @Kessler2017] and in a cohort of Swiss mountain rescuers [@Mikutta2022]. 
Frequencies of clinically relevant symptoms of anxiety and depression measured, respectively, with GAD-7 and PHQ-9, were compared with a representative sample of the general Austrian population reported by Humer et al. [@Humer2022]. 
Frequency and severity of depressive symptoms measured by the PHQ-8 tool in the study cohort [@Kroenke2002a] were compared with the Austrian 2019 microcensus estimates [@StatistikAustria2019a]. 
In those analyses, bootstrap with B = 1000 resamples was used for computation of the bias-corrected and accelerated (BCA) 95% confidence intervals (function `bmap()`, package [_bootStat_](https://github.com/PiotrTymoszuk/bootStat)). 
Significant differences were assumed for non-overlapping 95% confidence intervals of the mental symptom frequency estimates. 

## Semi-supervised clustering

Observations of the training subset of the study cohort were subjected to clustering in respect to the numeric psychometric scores (__Supplementary Table S\@ref(tab:tab-mental-battery)__). 
The score values were normalized and median-centered (function `center_data()`, package [_clustTools_](https://github.com/PiotrTymoszuk/clustTools)). 
For clustering, the PAM (partition around medoids) algorithm [@Schubert2019] with the cosine distance measure between observations [@Drost2018] was employed. 
The clustering object was constructed with the function `kcluster()` from the  [_clustTools_](https://github.com/PiotrTymoszuk/clustTools) package.
The choice of the clustering algorithm was motivated by 
its good explanatory performance measured by the fraction of explained clustering variance (ratio of the total between-cluster sum of squares to the total sum of squares), 
good separability between the clusters measured by mean silhouette width [@Rousseeuw1987], 
and superior reproducibility in 10-fold cross-validation [@Lange2004] (cluster assignment in the folds by an inverse distance weighted 27-nearest neighbors classifier) in a comparison with several other clustering algorithms presented in __Supplementary Figure S\@ref(fig:fig-clust-dev)A__. 
The explained variance, mean silhouette width and cross-validated accuracy statistics were computed with the methods `summary()` and `cv()` from the [_clustTools_](https://github.com/PiotrTymoszuk/clustTools) package. 
The number of clusters was chosen based on the bend of the curve of within-cluster sum of squares and the peak of mean silhouette statistic (method `plot()`, package [_ExDA_](https://github.com/PiotrTymoszuk/ExDA)) [@Rousseeuw1987; @Kassambara2020]. 
By this means, three mental health clusters were defined: the neutral, PTG (post-traumatic growth) and PTS (post-traumatic stress) cluster (__Supplementary Figure S\@ref(fig:fig-clust-dev)B__). 

Assignment of the training subset observations to the mental health clusters was accomplished with an inverse distance weighted 27-nearest neighbor classifier. 
Comparably good separation of the clusters could be discerned in the training and test subsets by 
a visual analysis of UMAP layouts and 
pairwise distance heat maps (__Supplementary Figure S\@ref(fig:fig-semi-clust)__). 
Additionally, the reproducibility of the clustering structure was assessed by 
mean silhouette width as a measure of general cluster separation (training: `r signif(semi_clust$stats$sil_width[1], 2)`, test: `r signif(semi_clust$stats$sil_width[2], 2)`) [@Rousseeuw1987], 
fraction of observations with negative silhouette widths as a metric of misclassification rate (training: `r signif(semi_clust$stats$frac_misclassified[1], 2)`, test: `r signif(semi_clust$stats$frac_misclassified[2], 2)`) [@Rousseeuw1987], 
fraction of explained clustering variance defined as ratio of the total between-cluster sum of squares to the total sum of squares (training: `r signif(semi_clust$stats$frac_var[1], 2)`, test: `r signif(semi_clust$stats$frac_var[2], 2)`), 
and fraction of 5-nearest neighbors placed in the same cluster as a measure of neighborhood preservation (training: `r signif(semi_clust$stats$frac_np[1], 2)`, test: `r signif(semi_clust$stats$frac_np[2], 2)`) [@Venna2001]. 
These statistics were computed with the `summary()` method from the [_clustTools_](https://github.com/PiotrTymoszuk/clustTools) package. 
The results of the comparison of the numeric statistics are presented in __Supplementary Figure S\@ref(fig:fig-cosine)A__. 
Distribution of the cluster frequency was similar in the training and test subset (__Supplementary Figure S\@ref(fig:fig-cosine)B__). 
An analysis of cosine cross-distances between the clusters in the training and test subsets revealed far higher similarity of the corresponding mental health clusters (i.e. neutral vs neutral, PTG vs PTG, PTS vs PTS) as compared with similarity of non-analogous clusters (e.g. neutral vs PTG) (distances computed with the function `cross_distance()`, package [_clustTools_](https://github.com/PiotrTymoszuk/clustTools); __Supplementary Figure S\@ref(fig:fig-cosine)C__). 
Finally, quality of semi-supervised clustering was investigated by comparison of normalized levels of the clustering variables between the mental health clusters in the training and test subset by Kruskal-Wallis test with $\eta^2$ effect size statistic (function `compare_variables()`, package [_ExDA_](https://github.com/PiotrTymoszuk/ExDA); __Figure 2__, __Supplementary Figure S\@ref(fig:fig-feat-hm)__, __Supplementary Table S\@ref(tab:tab-clust-fct)__).

Differences in frequencies of mental disorder symptoms as well as demographic, socioeconomic, clinical, accident- and recovery-related factors between the mental health clusters were assessed in the entire cohort by $\chi^2$ test with Cramer V effect size statistic and by Kruskal-Wallis test with $\eta^2$ effect size statistic for categorical and numeric variables, respectively (function `compare_variables()`, package [_ExDA_](https://github.com/PiotrTymoszuk/ExDA); __Supplementary Table S\@ref(tab:tab-clust-symptoms)__ and __S\@ref(tab:tab-clust-bcg)__).

## Assessment of effects of missing observations, annual income, prior mountain sport accidents, injury severity, hospitalization, and accident year on mental health cluster definition

To investigate effects observations excluded from the analysis due to an incomplete psychometric data set on definition of the mental health clusters, the excluded observations with less than 80% of missing psychometric entries were subjected to imputation with the 9-nearest neighbor algorithm implemented by the `impute.knn()` function from the R package _impute_ [@Hastie2023]. 
Subsequently, the mental health clusters were developed for the analysis cohort and for the analysis cohort appended with the imputed observations. 
Analogically, to explore effects of prior mountain sport accidents, the mental health clusters were developed for the entire cohort, the individuals having experienced a mountain accident in the past, and participants without prior mountain sport accidents. 
To evaluate effects of annual household income, the mental clusters were developed for the analysis cohort and the analysis cohort without, respectively, participants with no income, yearly income < 30000 Euro, yearly income ranging from 30000 to 45000 Euro and yearly income > 45000 Euro. 
To assess the impact of injury severity, the mental clusters were developed for the analysis cohort and the analysis cohort depleted of, respectively, individuals with mild (AIS 1), moderate (AIS 2), and severe-to-critical injuries (AIS $\geq$ 3). 
To investigate the effect of hospitalization, the mental health clusters were developed separately for the analysis cohort, non-hospitalized and hospitalized participants. 
To assess the impact of accident year, the mental clusters were developed for the analysis cohort without, respectively, accidents in 2018, 2019 and 2022. 
In each case, the unsupervised PAM/cosine distance clustering algorithm was used, i.e. the procedure employed for definition of the genuine mental health clusters. 
The effects of extending or depletion of the data set on the quality of the clustering structure was evaluated by comparing fractions of the explained clustering variance between the clustering solutions for the particular data set and for the analysis cohort [@Thabane2013]. 
Additionally, sizes of the neutral, PTG and PTS clusters expressed as percentage of all clustered observations were compared (__Supplementary Figure S\@ref(fig:fig-cluster-se)__ and __S\@ref(fig:fig-cluster-miss)__).

## Cluster assignment classifiers

Two types of multi-parameter machine learning classifiers of the mental health cluster assignment were developed in the training subset:

1. models employing candidate early predictors of cluster assignment, i.e. demographic, socioeconomic, medical history and accident-related explanatory factors available during acute medical management of the accident victim

2. models including additionally recovery-related predictors such as persistent physical health consequences, flashbacks or cautious behavior during sport

Of note, psychometric variables used for definition of the mental health clusters as well as symptoms of mental disorders, presence and frequency of flashbacks were excluded from the explanatory variable sets. 
The explanatory variables are listed in __Supplementary Table S\@ref(tab:tab-mod-variables)__.

The models employed the following algorithms: 
canonical random forests [@Breiman2001; @Wright2017], 
regularized neural networks with a single hidden layer [@Ripley2014], 
support vector machines with radial kernel [@Weston1998; @Karatzoglou2004], 
recursive partitioning [@Therneau2022; @Breiman2017], 
shrinkage discriminant analysis [@Ahdesmaki2010; @Ahdesmaki2022], 
conditional random forest [@Hothorn2006; @Strobl2007; @Hothorn2022], 
and elastic net multinomial regression [@Zou2005; @Friedman2010]. 
The optimal values of the algorithms' parameters were found by 10-fold cross-validation-based tuning with the maximal value of Cohen's $\kappa$ [@Cohen1960] as the tuning criterion. 
The tuning and fitting ('training') in the training subset of the study cohort was done with the wrapper function `train()` provided by the package _caret_ [@Kuhn2008]. 
For the random forest and conditional random forest algorithms, 1000 random trees each were constructed. 
Test statistic, p values, number of splits and other parameters of the conditional forest models were controlled with the `ForestControl` object returned by the convenience wrapper `cforest_unbiased()` provided by the _party_ package [@Hothorn2022]. 
The optimal algorithm parameter sets are listed in __Supplementary Table S\@ref(tab:tab-tuning)__. 
Predictions of the cluster assignment in the test subset of the study cohort were obtained with the `predict()` method from the [_caretExtra_](https://github.com/PiotrTymoszuk/caretExtra) package. 

Overall accuracy and Cohen's $\kappa$ statistics [@Cohen1960] were computed with the `summary()` method from the [_caretExtra_](https://github.com/PiotrTymoszuk/caretExtra) package. 
Brier scores [@Brier1950] were computed with the following formula:

$$BS = \frac{1}{N}\times\Sigma_{i = 1}^{N}\Sigma_{c = 1}^R(f_{ic} - o_{ic})^2$$
where $f_{tc}$ is the output probability of assignment of the i-th observation to the c-th cluster, 
$o_{ic}$ is the numeric-coded actual assignment of the i-th observation to the c-th cluster, 
$R$ is the total cluster number and 
$N$ is the total observation number. 

Performance statistics for the training subset, 10-fold cross-validation and test subset of the study cohort are listed in __Supplementary Table S\@ref(tab:tab-early-classifiers)__ and __Supplementary Table S\@ref(tab:tab-full-classifiers)__ for the classifiers employing the early and full predictor set, respectively. 

Variable importance statistic specific for the machine learning algorithm were extracted from the _caret_ models with the `varImp()` function from package _caret_ [@Kuhn2008]. 
They were: permutation importance for the random forest and conditional forest algorithm [@Hothorn2022; @Breiman2001], 
connection weight importance statistic for the neural network [@Garson1991], 
sum reduction in classification error attributed to each variable at each split for recursive partitioning [@Breiman2017], 
and linear model coefficient $\beta$ for elastic net regression [@Zou2005]. 
For support vector machines and discriminant analysis, the variable importance was computed based on area under the ROC curve for single predictors for discrimination between the cluster pairs [@Kuhn2008].

## Data and code availability

Anonymized patient data will be made available upon request to the corresponding author. 
The study analysis pipeline is available at https://github.com/PiotrTymoszuk/mental_accident.

\newpage

# Supplementary Tables

```{r tab-analysis-vars, tab.cap = 'Variables used in the analysis pipeline. The table is available as a supplementary Excel file.'}

suppl_tables$analysis_vars[1, 1] %>% 
  mutate(`Variable name in R` = '') %>% 
  set_names(' ') %>% 
  flextable %>% 
  set_widths(16)

```

\newpage

```{r tab-mental-battery, tab.cap = 'Mental health assessment battery.'}

flextable::flextable(suppl_tables$mental_battery) %>% 
  set_widths(c(2.3, 7, 10)) %>% 
  merge_v(1) %>% 
  footnote(1, 2:3, 
           value = as_paragraph('GAD-7: 7-item general anxiety disorder scale; PHQ-9: 9-item patient health questionnaire for depressive symptoms; PHQ-15: 15-item patient health questionnaire for common somatic symptoms as a substitute for somatization; PHQ-panic: patient health questionnaire module for panic disorders; EUROHIS-QOL 8: 8-item EUROHIS project quality of life scale; SOC-9L: Leipzig 9-item sense of coherence questionnaire; RS13: 13-item resilience scale; PCL-5: PTSD checklist for DSM-5; PTGI: post-traumatic growth inventory'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  theme_vanilla


```

\newpage

```{r tab-consistency, tab.cap = "Consistency of the psychometric tools used in the study measured by McDonald's omega."}

flextable::flextable(suppl_tables$consistency) %>% 
  set_widths(c(4.5, 3, 3)) %>% 
   footnote(1, 1, 
           value = as_paragraph('GAD-7: 7-item general anxiety disorder scale; PHQ-9: 9-item patient health questionnaire for depressive symptoms; PHQ-15: 15-item patient health questionnaire for common somatic symptoms as a substitute for somatization; PHQ-panic: patient health questionnaire module for panic disorders; EUROHIS-QOL 8: 8-item EUROHIS project quality of life scale; SOC-9L: Leipzig 9-item sense of coherence questionnaire; RS13: 13-item resilience scale; PCL-5: PTSD checklist for DSM-5; PTGI: post-traumatic growth inventory'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  theme_vanilla

```

\newpage

```{r tab-no-response, tab.cap = 'Significant differences between patients who did not respond to the study invitation and the analyzed study participants. Numeric variables are presented as medians with interquartile ranges (IQR). Categorical variables are presented as percentages and counts within the complete observation set.'}

flextable::flextable(suppl_tables$no_response) %>% 
  set_widths(c(2.8, 6.3, 6.3, 2.5, 2.2)) %>% 
   footnote(1, 1, 
           value = as_paragraph('AIS: abbreviated injury scale; ICD-10: 10th version of the International Statistical Classification of Diseases and Related Health Problems.'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  footnote(1, 4:5, 
           value = as_paragraph('Numeric variables: Mann-Whitney test with r effect size statistic; categorical variables: \u03C7\u00B2 test with Cramer V effect size statistic. P values corrected for multiple testing with the false discovery rate method.'), 
           part = 'header', 
           ref_symbols = 'b') %>% 
  theme_vanilla

```

\newpage

```{r tab-missing, tab.cap = 'Significant differences between the study survey responders excluded from analysis due to missingness of psychometric data and the analyzed study participants. Numeric variables are presented as medians with interquartile ranges (IQR). Categorical variables are presented as percentages and counts within the complete observation set.'}

flextable::flextable(suppl_tables$missing) %>% 
  set_widths(c(3.2, 5.8, 5.8, 2.5, 2.2)) %>% 
  footnote(1, 1, 
           value = as_paragraph('AIS: abbreviated injury scale; K: 1000 Euro; EUR: Euro.'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  footnote(1, 4:5, 
           value = as_paragraph('Numeric variables: Mann-Whitney test with r effect size statistic; categorical variables: \u03C7\u00B2 test with Cramer V effect size statistic. P values corrected for multiple testing with the false discovery rate method.'), 
           part = 'header', 
           ref_symbols = 'b') %>% 
  theme_vanilla

```

\newpage

```{r tab-aut-population, tab.cap = 'Comparison of sociodemographic features of the study cohort and estimates for the general Austrian population. Numeric variables are presented as medians with interquartile ranges (IQR). Categorical variables are presented as percentages and counts within the complete observation set.'}

flextable::flextable(suppl_tables$aut_population) %>% 
  set_widths(c(3.5, rep(5, 2), 2.8, 2.8)) %>% 
  footnote(7, 1, 
           value = as_paragraph('In the study survey: participants reporting a chronic pre-existing physical illness or a mental disorder diagnosed by a medical professional.'), 
           ref_symbols = 'a', 
           part = 'body') %>%
  footnote(1, 4:5, 
           value = as_paragraph('Numeric variables: Mann-Whitney test with r effect size statistic, categorical variables: \u03C7\u00B2 test with Cramer V effect size statistic.'), 
           ref_symbols = 'b', 
           part = 'header') %>% 
  theme_vanilla

```

\newpage

```{r tab-train-test, tab.cap = 'Significant differences between the training and test subset of the study cohort. Numeric variables are presented as medians with interquartile ranges (IQR). Categorical variables are presented as percentages and counts within the complete observation set.'}

flextable::flextable(suppl_tables$train_test) %>% 
  set_widths(c(4, 4, 4, 2.5, 2.2)) %>% 
  footnote(1, 1, 
           value = as_paragraph('RS13: 13-item resilience scale; EUROHIS-QOL 8: 8-item EUROHIS project quality of life scale.'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  footnote(1, 4:5, 
           value = as_paragraph('Numeric variables: Mann-Whitney test with r effect size statistic; categorical variables: \u03C7\u00B2 test with Cramer V effect size statistic. P values corrected for multiple testing with the false discovery rate method.'), 
           part = 'header', 
           ref_symbols = 'b') %>% 
  theme_vanilla

```


\newpage

```{r tab-clust-fct, tab.cap = 'Differences in psychometric clustering factors between the mental health clusters. Numeric variables are presented as medians with interquartile ranges (IQR). Statistical significance was determined by false discovery rate-corrected Kruskal-Wallis test with eta-square effect size statistic. The table is available in a supplementary Excel file.'}

suppl_tables$clust_fct[1, 1] %>% 
  mutate(Variable = '') %>% 
  set_names(' ') %>% 
  flextable %>% 
  set_widths(16)

```

\newpage

```{r tab-clust-symptoms, tab.cap = 'Frequency of mental disorder symptoms in the mental health clusters in the entire cohort. Categorical variables are presented as percentages and counts within the clusters.'}

flextable::flextable(suppl_tables$clust_symptoms) %>% 
  set_widths(c(4, rep(4, 3), 2.5, 2.3)) %>% 
  footnote(1, 1, 
           value = as_paragraph('GAD-7: 7-item general anxiety disorder scale; PHQ-9: 9-item patient health questionnaire for depressive symptoms; PHQ-15: 15-item patient health questionnaire for common somatic symptoms as a substitute for somatization; PHQ-panic: patient health questionnaire module for panic disorders; RS13: 13-item resilience scale; PCL-5: PTSD checklist for DSM-5; PTSD: post-traumatic stress disorder.'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  footnote(1, 5:6, 
           value = as_paragraph('\u03C7\u00B2 test with Cramer V effect size statistic. P values were corrected for multiple testing with the false discovery rate method.'), 
           part = 'header', 
           ref_symbols = 'b') %>% 
  theme_vanilla

```

\newpage

```{r tab-clust-bcg, tab.cap = 'Differences in demographic, socioeconomic, clinical, accident- and recovery-related factors, and between the mental clusters in the entire cohort. Significant effects are presented, the full table is available as a supplementary Excel file. Numeric variables are presented as medians with interquartile ranges (IQR). Categorical variables are presented as percentages and counts within the clusters.'}

suppl_tables$clust_bcg %>%
  filter(!stri_detect(Significance, regex = '^ns')) %>% 
  flextable %>% 
  set_widths(c(3, rep(4.3, 3), 2.5, 2.3)) %>% 
  footnote(1, 1, 
           value = as_paragraph('psychological support need: subjective need for psychological or psychiatric support following the accident; physical health consequences: physical health consequences related to the accident.'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  footnote(1, 5:6, 
           value = as_paragraph('Numeric variables: Kruskal-Wallis test with \u03B7\u00B2 effect size statistic. Categorical variables: \u03C7\u00B2 test with Cramer V effect size statistic. P values were corrected for multiple testing with the false discovery rate method.'), 
           part = 'header', 
           ref_symbols = 'b') %>% 
  theme_vanilla

```

\newpage

```{r tab-mod-variables, tab.cap = 'Sets of explanatory factors used for modeling of the mental health cluster assignment.'}

flextable::flextable(suppl_tables$mod_variables) %>% 
  set_widths(c(2.5, 15.5)) %>% 
  footnote(1, 1, 
           value = as_paragraph('early predictors: variables available during acute medical management of the patient; full predictor set: variables available during acute medical management of the patient and during follow-up.'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  theme_vanilla

```

\newpage

```{r tab-tuning, tab.cap = 'The optimal combinations of machine learning algorithm parameters found in 10-fold cross-validation of the training subset of the study cohort.'}

flextable::flextable(suppl_tables$tuning) %>% 
  set_widths(c(2, 2.5, 8.5)) %>% 
  merge_v(1) %>%
  footnote(1, 1, 
           value = as_paragraph('early predictors: variables available during acute medical management of the patient; full predictor set: variables available during acute medical management of the patient and during follow-up.'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  footnote(1, 2, 
           value = as_paragraph('RF: random forest; NNet: neural network with a single hidden layer; SVM/radial: support vector machines with radial kernel; RPart: recursive partitioning; SDA: shrinkage discriminant analysis; cForest: conditional random forest; Elastic Net: elastic net multinomial regression.'), 
           part = 'header', 
           ref_symbols = 'b') %>% 
  theme_vanilla

```

\newpage

```{r tab-early-classifiers, tab.cap = 'Performance statistics of machine learning classifiers at predicting the mental health cluster assignment. Models employing early predictors available during acute medical management of the patient.'}

flextable::flextable(suppl_tables$early_classifiers) %>% 
  set_widths(c(2.3, 2.5, rep(2.3, 5))) %>% 
  merge_v(1) %>% 
  footnote(1, 1, 
           value = as_paragraph('RF: random forest; NNet: neural network with a single hidden layer; SVM/radial: support vector machines with radial kernel; RPart: recursive partitioning; SDA: shrinkage discriminant analysis; cForest: conditional random forest; Elastic Net: elastic net multinomial regression.'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  footnote(1, 2, 
           value = as_paragraph('CV: cross-validation'), 
           part = 'header',  
           ref_symbols = 'b') %>% 
  theme_vanilla

```

\newpage

```{r tab-full-classifiers, tab.cap = 'Performance statistics of machine learning classifiers at predicting the mental health cluster assignment. Models employing the full predictor set available during acute medical management of the patient and follow-up.'}

flextable::flextable(suppl_tables$full_classifiers) %>% 
  set_widths(c(2.3, 2.5, rep(2.3, 5))) %>% 
  merge_v(1) %>% 
  footnote(1, 1, 
           value = as_paragraph('RF: random forest; NNet: neural network with a single hidden layer; SVM/radial: support vector machines with radial kernel; RPart: recursive partitioning; SDA: shrinkage discriminant analysis; cForest: conditional random forest; Elastic Net: elastic net multinomial regression.'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  footnote(1, 2, 
           value = as_paragraph('CV: cross-validation'), 
           part = 'header',  
           ref_symbols = 'b') %>% 
  theme_vanilla

```

\newpage

# Supplementary Figures

```{r fig-accident, fig.width = figur::convert(suppl_figures$accident, to = 'in')$w, fig.height = figur::convert(suppl_figures$accident, to = 'in')$h, fig.cap = 'Age, mountain sport type, and accident month in the study cohort and Austrian national registry of mountain accidents.'}

suppl_figures$accident$plot

```

__Supplementary Figure S\@ref(fig:fig-accident). Age, mountain sport type, and accident month in the study cohort and Austrian national registry of mountain accidents.__ 

_Age class distribution (A), mountain sport types (B), and accident months (C) were compared between the study cohort and victims of mountain sport accidents in Austria in 2023. Frequencies for the nation-wide data set of mountain accidents were extracted from the annual report of the Austrian Board of Mountain Safety. In the comparison of the age class distribution, only individuals older than 20 years were included. In the comparison of sport types, non-sportive mountain accidents (e.g. during hunting or forestry) were excluded from the national statistic. Non-classifiable sport types (category 'other') in the study cohort were excluded from the analysis presented in (C). Statistical significance of the global differences was determined by $\chi^2$ test with Cramer's V effect size statistic. Pairwise differences for particular sport types, months and age classes were assessed by $\chi^2$ test corrected for multiple testing with the Holm method. Percentages of categories within the complete observation sets are presented as bar plots. Bars are labeled with the corresponding percent values. Total observation numbers are displayed in the plot legends. Global effect sizes and p values are presented in the plot captions. Significant results of post-hoc tests are highlighted with bold X axis labels._

_alpine skiing: alpine skiing and snowboarding in secured areas of ski resorts; ski touring/freeride: alpine skiing and snowboarding performed besides secured areas of ski resorts; sledding: sledding and bob sledding; ice climbing: ice and mixed climbing; climbing: bouldering, sport and rock climbing; mountaineering: high mountain and glacier tours; biking: road, cross-country and mountain biking._ 

\newpage

```{r fig-parts-ptsd, fig.width = figur::convert(suppl_figures$parts_ptsd, to = 'in')$w, fig.height = figur::convert(suppl_figures$parts_ptsd, to = 'in')$h, fig.cap = 'Injured body regions and symptoms of PTSD in the study cohort.'}

suppl_figures$parts_ptsd$plot

```

__Supplementary Figure S\@ref(fig:fig-parts-ptsd). Injured body regions and symptoms of PTSD in the study cohort.__ 

_(A) Distribution of injured body regions presented in a bar plot. The number of complete observations is indicated in the plot caption._

_(B) Scores of particular domains of the PCL-5 tool evaluating symptoms of post-traumatic stress disorder (PTSD) presented in violin plots. Single observations are visualized as points. Medians and interquartile ranges are represented by red diamonds and whiskers. The number of complete observations is indicated in the plot caption._

_(C) Frequency and overlap of clinically relevant PTSD symptoms captured by particular domains of the PCL-5 scale presented in an upset plot. Percentages of participants screened positive for the domain B, C, D or E PTSD symptoms are displayed in as red bars. Percentages of participants with single and overlapping domain B, C, D or E PTSD symptoms are presented as green bars. The number of complete observations is indicated in the plot caption._

\newpage

```{r fig-qol-ptg, fig.width = figur::convert(suppl_figures$qol_ptg, to = 'in')$w, fig.height = figur::convert(suppl_figures$qol_ptg, to = 'in')$h, fig.cap = 'Scores of quality of life and post-traumatic growth in the study cohort.'}

suppl_figures$qol_ptg$plot

```

__Supplementary Figure S\@ref(fig:fig-qol-ptg). Scores of quality of life and post-traumatic growth in the study cohort.__ 

_(A) Scores of the domains of the EUROHIS project 8-item quality of life scale (EUROHIS-QOL 8) presented in a bar plot. The number of complete observations is displayed in the plot caption._

_(B) Scores of the domains of the post-traumatic growth inventory (PTGI) scale presented in a violin plots. Single observations are visualized as points. Red diamonds with whiskers represent medians with interquartile ranges. The number of complete observations is indicated in the plot caption._

\newpage

```{r fig-ptsd-literature, fig.width = figur::convert(suppl_figures$ptsd_literature, to = 'in')$w, fig.height = figur::convert(suppl_figures$ptsd_literature, to = 'in')$h, fig.cap = 'Comparison of frequency of traumatic events, manifest PTSD, and symptoms of  PTSD in the study cohort and literature.'}

suppl_figures$ptsd_literature$plot

```

__Supplementary Figure S\@ref(fig:fig-ptsd-literature). Comparison of frequency of traumatic events, manifest PTSD, and symptoms of  PTSD in the study cohort and literature.__ 

_Frequency estimates of traumatic events, manifest PTSD and PTSD symptoms with bias-corrected and accelerated (BCA) 95% confidence computed by bootstrap are depicted in Forest plots._

_(A) Comparison of frequencies of traumatic events and manifest PTSD in the study cohort with estimates of population prevalence of lifetime traumatic events and manifest PTSD in published surveys. Tools used for identification of traumatic events and PTSD symptoms are indicated in the Y axis (CIDI: composite international diagnostic interview, DSM-5: diagnostic and statistical manual of mental disorders, 5^th^ edition, PDS: post-traumatic stress diagnostic scale)._

_(B) Comparison of manifest PTSD and PTSD symptoms in the study cohort and the cohort of Swiss mountain rescuers reported by Mikutta and colleagues. PTSD symptoms were assessed by the PCL-5 tool and are subsumed under the B, C, B, and E domains. Manifest PTSD is defined as positivity for all domains of the PCL-5 instrument._ 

\newpage

```{r fig-mental-literature, fig.width = figur::convert(suppl_figures$mental_literature, to = 'in')$w, fig.height = figur::convert(suppl_figures$mental_literature, to = 'in')$h, fig.cap = 'Comparison of frequency of clinically relevant symptoms of anxiety and depression, and of resilience scoring in the study cohort and literature.'}

suppl_figures$mental_literature$plot

```

__Supplementary Figure S\@ref(fig:fig-mental-literature). Comparison of frequency of clinically relevant symptoms of anxiety and depression, and of resilience scoring in the study cohort and literature.__ 

_Frequency estimates of mental disorder symptoms with bias-corrected and accelerated (BCA) 95% confidence computed by bootstrap are depicted in Forest plots. Mean resilience scores obtained with the RS13 tool with standard deviations (SD) are shown in a Forest plot._

_(A) Comparison of frequency of anxious and depressive symptoms measured by the GAD-7 and PHQ-9 instruments in the study cohort with frequency of anxious and depressive symptoms reported in a representative sample of Austrian population in 2022 by Humer and colleagues._

_(C) Comparison of scores of resilient coping in the study cohort, the cohort of Swiss mountain rescuers published by Mikutta et al., and samples of the Tyrolean (Chernova et al.) and German population (Leppert et al.) investigated with the RS13 instrument._

\newpage

```{r fig-clust-dev, fig.width = figur::convert(suppl_figures$clust_dev, to = 'in')$w, fig.height = figur::convert(suppl_figures$clust_dev, to = 'in')$h, fig.cap = 'Definition of the mental health clusters in the training subset of the study cohort.'}

suppl_figures$clust_dev$plot

```

__Supplementary Figure S\@ref(fig:fig-clust-dev). Definition of the mental health clusters in the training subset of the study cohort.__ 

_The mental health clusters were defined in respect to psychometric scoring in the training subset of the study cohort by PAM (partition around medoids) with cosine distance between the observations._

_(A) Comparison of explanatory performance, cluster separation and reproducibility of various clustering algorithms in the training subset. The explanatory performance was measured as a fraction of explained clustering variance (ratio of between-cluster sum of squares to total sum of squares). The cluster separation was assessed with average silhouette width. The reproducibility was assessed by the rate of correct cluster assignment in 10-fold cross-validation (CV) with cluster assignment in the folds by an inverse distance weighted 27-nearest neighbors classifier. Note the superior stability of the PAM/cosine distance algorithm._

_(B) Determination of the cluster number by the bend of the within-cluster sum of squares curve and the peak mean silhouette statistic._

\newpage

```{r fig-semi-clust, fig.width = figur::convert(suppl_figures$semi_clust, to = 'in')$w, fig.height = figur::convert(suppl_figures$semi_clust, to = 'in')$h, fig.cap = 'Semi-supervised clustering.'}

suppl_figures$semi_clust$plot

```

__Supplementary Figure S\@ref(fig:fig-semi-clust). Semi-supervised clustering.__ 

_The mental health clusters were defined in respect to psychometric scoring in the training subset of the study cohort by PAM (partition around medoids) with cosine distance between the observations. Assignment of the test subset observations to the mental health clusters was done with the inverse distance weighted 27-nearest neighbors classifier. By this procedure, three mental health clusters were identified: neutral, PTG (post-traumatic growth) and PTS (post-traumatic stress). Numbers of observations in the mental health clusters are shown in the plot legend in (A)._

_(A) Observations in the training and test subsets of the study cohorts were subjected to two-dimensional UMAP (uniform manifold approximation and projection) in respect to the psychometric scores. UMAP layouts are shown in scatter plots. Points represent single samples. Point color codes for the cluster assignment._

_(B) Pairwise cosine distances between observations in the mental health clusters of the training and test subsets presented in heat maps._

\newpage

```{r fig-cosine, fig.width = figur::convert(suppl_figures$cosine, to = 'in')$w, fig.height = figur::convert(suppl_figures$cosine, to = 'in')$h, fig.cap = 'Distribution of the mental health clusters and cosine distances between the mental health clusters in the training and test subset of the study cohort.'}

suppl_figures$cosine$plot

```

__Supplementary Figure S\@ref(fig:fig-cosine). Distribution of the mental health clusters and cosine distances between the mental health clusters in the training and test subset of the study cohort.__ 

_Study cohorts observations were assigned to the neutral, PTG (post-traumatic growth) and PTS (post-traumatic stress) mental health clusters by semi-supervised clustering as presented in Supplementary Figure S\@ref(fig:fig-semi-clust)._

_(A) Comparison of numeric statistics of quality of clustering structures between the training and test subset of the study cohort. Mean silhouette width served as a measure of cluster separation. Fractions of observations with negative values of the silhouette width statistics were used to gauge misclassification rates. Explained clustering variance was defined as ratio of the total between-cluster sum of squares to the total sum of squares. Neighborhood preservation was measured by a fraction of the 5-nearest neighbors placed in the same cluster. SS: sum of squares, NN: nearest neighbors._

_(B) Percentages of observations in the training and test subsets of the study cohort in the mental health clusters. Numbers of complete observations are indicated in the Y axis._

_(C) Cosine cross-distances between the mental health clusters in the training and test subsets of the study data set visualized as a heat map. Average cross-distances with 95% percentile range are indicated in the tiles._

\newpage

```{r fig-feat-hm, fig.width = figur::convert(suppl_figures$feat_hm, to = 'in')$w, fig.height = figur::convert(suppl_figures$feat_hm, to = 'in')$h, fig.cap = 'Levels of psychometric scores used for the cluster definition in the mental health clusters.'}

suppl_figures$feat_hm$plot

```

__Supplementary Figure S\@ref(fig:fig-feat-hm). Levels of psychometric scores used for the cluster definition in the mental health clusters.__ 

_Levels of psychometric scores used in clustering in the mental health clusters. Normalized, median-centered score values (Z scores) are presented as heat maps. Numbers of observations in the clusters are displayed in the plot captions. PSS4: 4-item perceived stress scale; GAD-7: 7-item general anxiety disorder scale; PHQ: patient health questionnaire; EUROHIS-QOL 8: 8-item EUROHIS project quality of life scale; SOC-9L: Leipzig 9-item sense of coherence questionnaire; RS13: 13-item resilience scale; PCL-5: PTSD checklist for DSM-5; PTGI: post-traumatic growth inventory; PTSD: post-traumatic stress disorder._

\newpage

```{r fig-cluster-se, fig.width = figur::convert(suppl_figures$cluster_se, to = 'in')$w, fig.height = figur::convert(suppl_figures$cluster_se, to = 'in')$h, fig.cap = 'Effects of incomplete psychometry data, annual income, prior mountain sport accidents, injury severity, and hospitalization on development of the mental health clusters.'}

suppl_figures$cluster_se$plot

```

__Supplementary Figure S\@ref(fig:fig-cluster-se). Effects of incomplete psychometry data, annual income, prior mountain sport accidents, injury severity, and hospitalization on development of the mental health clusters.__ 

_The mental health clusters were developed by PAM/cosine distance clustering for the analyzed study cohort, for the analyzed study cohort appended with participants with missing and imputed psychometric variables, participants with and without prior mountain sport accidents, hospitalized and non-hospitalized participants, the analysis cohort without each of no, low, intermediate and high annual income, the analysis cohort without each of 2018, 2019 and 2020 accidents, as well as for the analysis cohort with exclusion of participants with minor (abbreviated injury scale [AIS] 1), moderate (AIS2) and severe-to-critical injuries (AIS $\geq$ 3). Fractions of explained clustering variance (ratio of total between-cluster sum of squares to total sum of squares) were compared between the mental health cluster assignment of the entire cohort and the mental clusters of collectives described above._

_(A) Percent differences in fractions of explained variance between the mental health clusters of the analysis cohort and the mental health clusters in the analysis cohort appended with or depleted of the subsets indicated in the Y axis. Total numbers of observations are displayed in the Y axis._

_(B) Distribution of the mental health clusters sizes expressed as percentages of all observations presented in a stack plot. Total observation numbers are displayed in the Y axis._

\newpage

```{r fig-cluster-miss, fig.width = figur::convert(suppl_figures$cluster_miss, to = 'in')$w, fig.height = figur::convert(suppl_figures$cluster_miss, to = 'in')$h, fig.cap = 'Mental health cluster assignment of participants excluded from the analysis due incomplete psychometry data.'}

suppl_figures$cluster_miss$plot

```

__Supplementary Figure S\@ref(fig:fig-cluster-miss). Mental health cluster assignment of participants excluded from the analysis due incomplete psychometry data.__ 

_Incomplete psychometry data were imputed for participants with < 80% missing answers in the mental health battery by a 9-nearest neighbors regressor. The mental health clusters were developed for separately the analysis cohort (A) and the analysis cohort appended with the imputed psychometry data (B). Normalized levels of the clustering variables (Z-scores) in the mental health clusters are visualized as heat maps. Assignment of the imputed observations to the mental health clusters is depicted in the color bar below the heat map in (B). Numbers of observations in the clusters are displayed in the plot captions._

\newpage

```{r fig-demo, fig.width = figur::convert(suppl_figures$demo, to = 'in')$w, fig.height = figur::convert(suppl_figures$demo, to = 'in')$h, fig.cap = 'Employment status, prior mountain sport accidents, and accident details in the mental health clusters.'}

suppl_figures$demo$plot

```

__Supplementary Figure S\@ref(fig:fig-demo). Employment status, prior mountain sport accidents, and accident details in the mental health clusters.__ 

_Distribution of employment status, frequency of mountain sport accidents in the past, distribution of the accidents in the seasons, frequency of being alone during the accident and number of injured persons in the mental health clusters. Statistical significance was determined by $\chi^2$ test with Cramer V effect size statistic. P values were corrected for multiple testing with the false discovery rate method. Percentages of variable's categories in the entire study cohort are presented in stack plots. Effect sizes and p-values are displayed in the plot captions. Numbers of observations in the clusters are presented in the X axes._

\newpage

```{r fig-cluster-sport, fig.width = figur::convert(suppl_figures$cluster_sport, to = 'in')$w, fig.height = figur::convert(suppl_figures$cluster_sport, to = 'in')$h, fig.cap = 'Mountain sport types in the clusters.'}

suppl_figures$cluster_sport$plot

```

__Supplementary Figure S\@ref(fig:fig-cluster-sport). Mountain sport types in the clusters.__ 

_The global difference in distribution of accident sport types between the mental health clusters was compared by $\chi^2$ test with Cramer's V effect size statistic. Post-hoc testing for differences in frequency of particular sport types between the clusters was done with Holm-corrected $\chi^2$ test with Cramer's V effect size statistic. Percentages of sport types within the clusters are presented in bar plots. Effect size statistic and p value for the global difference are indicated in the plot caption. Results of post-hoc tests are displayed in the Y axis. Numbers of observations in the clusters are shown in the plot legend._

\newpage

```{r fig-importance-early, fig.width = figur::convert(suppl_figures$importance_early, to = 'in')$w, fig.height = figur::convert(suppl_figures$importance_early, to = 'in')$h, fig.cap = 'Variable importance metrics for the random forest, support vector machine, discriminant analysis, and conditional random forest algorithms. Predictors available during acute medical management of the patient.'}

suppl_figures$importance_early$plot

```

__Supplementary Figure S\@ref(fig:fig-importance-early). Variable importance metrics for the random forest, support vector machine, discriminant analysis, and conditional random forest algorithms. Predictors available during acute medical management of the patient.__ 

_Assignment to the mental health clusters was modeled with demographic, medical history and accident-related explanatory factors available during acute medical management of the patient. Psychometric variables used for cluster definition, mental disorder symptoms, resilience classes, presence and frequency of flashbacks and variables concerning recovery and long term consequences of the accident were excluded from the explanatory factor set. Variable importance metrics of machine learning algorithms with the best performance at predicting the mental health cluster assignment in the test subset of the study cohorts were computed. Importance metrics for the top 20 most important variables are presented as bar plots._
_(A) Random forest, (B) support vector machines with radial kernel, (C) shrinkage discriminant analysis, (D) conditional random forest._

\newpage

```{r fig-full-class, fig.width = figur::convert(suppl_figures$full_class, to = 'in')$w, fig.height = figur::convert(suppl_figures$full_class, to = 'in')$h, fig.cap = 'Assignment of accident victims to the mental health clusters based on explanatory factors available during acute medical management of the patient and long-term follow-up.'}

suppl_figures$full_class$plot

```

__Supplementary Figure S\@ref(fig:fig-full-class). Assignment of accident victims to the mental health clusters based on explanatory factors available during acute medical management of the patient and long-term follow-up.__ 

_Assignment to the mental health clusters was modeled with demographic, medical history, accident- and recovery-related explanatory factors available during acute medical management of the patient and follow-up. Psychometric variables used for cluster definition, symptoms of mental disorders, resilience classes as well as presence and frequency of flashbacks were excluded from the explanatory factor set._

_(A) Accuracy of the predicted Cluster assignment and predictive performance of the modeling algorithms was assessed by overall accuracy, Cohen's $\kappa$ inter-rater accuracy metric (high values indicate good accuracy) and Brier score (low values indicate good performance) in the training and test subsets of the study cohort. Performance metrics are presented in scatter plots. Point size codes for the overall cluster assignment accuracy. Point color codes for the modeling algorithm. Numbers of complete observations are displayed in the plot captions._

_(B) Sensitivity (Se) and specificity (Sp) of detection of participants assigned to the PTS cluster (post-traumatic stress) investigated by receiver-operating characteristic in the training and test subset of the study cohort. Sensitivity and specificity values are indicated in the plots. Line color codes for the modeling algorithm. Numbers of complete observations and observations in the PTS cluster are indicated in the plot captions._

_RF: random forest; NNet: neural network with a single hidden layer; SVM/radial: support vector machines with radial kernel; RPart: recursive partitioning; SDA: shrinkage discriminant analysis; cForest: conditional random forest; Elastic Net: elastic net multinomial regression._

\newpage

```{r fig-importance-full, fig.width = figur::convert(suppl_figures$importance_full, to = 'in')$w, fig.height = figur::convert(suppl_figures$importance_full, to = 'in')$h, fig.cap = 'Variable importance metrics for the random forest, support vector machine, discriminant analysis, and conditional random forest algorithms. Predictors available during acute medical management of the patient and follow-up.'}

suppl_figures$importance_full$plot

```

__Supplementary Figure S\@ref(fig:fig-importance-full). Variable importance metrics for the random forest, support vector machine, discriminant analysis, and conditional random forest algorithms. Predictors available during acute medical management of the patient and follow-up.__ 

_Assignment to the mental health clusters was modeled with demographic, medical history, accident- and recovery-related explanatory factors available during acute medical management of the patient and follow-up. Psychometric variables used for cluster definition, symptoms of mental disorders, resilience classes as well as presence and frequency of flashbacks were excluded from the explanatory factor set. Variable importance metrics of machine learning algorithms with the best performance at predicting the mental health cluster assignment in the test subset of the study cohorts were computed. Importance metrics for the top 20 most important variables are presented as bar plots._
_(A) Random forest, (B) support vector machines with radial kernel, (C) shrinkage discriminant analysis, (D) conditional random forest._

\newpage

# References