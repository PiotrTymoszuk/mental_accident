---
title: "Three distinct patterns of mental response after mountain sport accidents"
subtitle: "Supplementary Material"
author: "Psychiatry Study Team"
date: "`r format(Sys.time(), '%Y-%m-%d')`"

output: 
  bookdown::word_document2:   
    reference_docx: ms_template.docx
    
bibliography: ptsd_biblio.bib
csl: frontiers_medical.csl

header-includes:
  \usepackage{longtable}
  \usepackage{tabu}
  \usepackage{caption}
  \usepackage{makecell}
  \usepackage{pdflscape}
  \usepackage{array}
  \usepackage{booktabs}
  \usepackage{threeparttable}
  \usepackage{threeparttablex}
  \usepackage{wrapfig}
  \usepackage{multirow}
  \usepackage[normalem]{ulem}
  \usepackage{colortbl}
  \usepackage{xcolor}
  \usepackage{float} \floatplacement{figure}{H} \floatplacement{table}{H}
  \newcommand{\beginsupplement}{\setcounter{table}{0}  \renewcommand{\thetable}{S\arabic{table}}       \setcounter{figure}{0} \renewcommand{\thefigure}{S\arabic{figure}}}
---

```{r, setup, include = FALSE}

knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE, 
                      message = FALSE, 
                      dev = "png", 
                      dpi = 600, 
                      tab.cap.pre = 'Supplementary Table ', 
                      tab.cap.sep = " ", 
                      tab.cap.style = 'Table Heading')

set_flextable_defaults(font.family = 'Cambria', font.size = 9)


```

\newpage

# Supplementary Methods

## Software

Data analysis and transformation was accomplished with R version 4.2.0. 
The study dataset was imported from an SPSS file with the _foreign_ package [@RCoreTeam]. 
Tabular data were handled with the _tidyverse_ package bundle [@Wickham2019] and the packages _rlang_ [@Henry2022] and [_trafo_](https://github.com/PiotrTymoszuk/trafo). 
Test variables were handled with _stringi_ [@Gagolewski2021].

For distribution testing (normality, variance, Gini index), the packages [_ExDA_](https://github.com/PiotrTymoszuk/ExDA), _rstatix_ [@Kassambara2021] and _DescTools_ [@Signorell2022] were utilized. 
Consistency of psychometric tools was assessed with the packages _psych_ [@Revelle2022], [_ExDA_](https://github.com/PiotrTymoszuk/ExDA) and [_clustTools_](https://github.com/PiotrTymoszuk/clustTools). 
Clustering tendency was investigated with _factoextra_ [@Kassambara2020] and [_clustTools_](https://github.com/PiotrTymoszuk/clustTools). 
Statistical hypothesis testing and correlation analyses were accomplished with [_ExDA_](https://github.com/PiotrTymoszuk/ExDA), _rstatix_ [@Kassambara2021].

For clustering, the package [_clustTools_](https://github.com/PiotrTymoszuk/clustTools) with implementation of algorithms and distance measures from _factoextra_, _cluster_ and _philentropy_ [@Schubert2019; @Drost2018; @Kassambara2020] was utilized. 
UMAP (uniform manifold approximation and projection) was done with the _umap_ package [@Konopka2022; @McInnes2018]. 
Univariable mental cluster assignment classifiers were developed with the _OneR_ [@VonJouanne-Diedrich2017; @Holte1993]. 
A multi-variable classifier for mental cluster assignment was developed with the conditional random forest algorithm [@Hothorn2006; @Strobl2007] implemented in the _party_ package [@Hothorn2022]. 
Accuracy of the classifiers was assessed with the packages _caret_ [@Kuhn2008] and [_caretExtra_](https://github.com/PiotrTymoszuk/caretExtra).

Results were visualized with _ggplot_ (bar plots, box plots and heat maps of confusion matrices) [@Wickham2016], [_ExDA_](https://github.com/PiotrTymoszuk/ExDA) (violin, stack and ribbon plots) and [_clustTools_](https://github.com/PiotrTymoszuk/clustTools) (cluster quality control plots, clustering features heat maps, distance heat maps, scatter plots of UMAP layouts). 
Figures were created with the package _cowplot_ [@Wilke2019]. 
Tables were generated with _flextable_ [@Gohel2022]. 
The manuscript and Supplementary Material were written in _rmarkdown_ [@Allaire2022] with the package _bookdown_ [@Xie2016]. 
Figures, tables and R expressions in the markdown documents were managed with the development package [_figur_](https://github.com/PiotrTymoszuk/figur). 
The markdown documents were rendered with _knitr_ [@Xie2022], _bookdown_ [@Xie2016] with `author-info-blocks.lua` and `scholarly-metadata.lua` scripts by Albert Krewinkel and JÃ¶rn Krenzer.

## Data import and transformation

The study data set was imported from an SPSS file with raw study data (function `read.spss()`, package _foreign_). 
The list of extracted variables with their description is available in __Supplementary Table S\@ref(tab:tab-analysis-vars)__. 
A total of `r nrow(ptsd$dataset)` participants with the complete set of psychometric battery variables (__Supplementary Table S\@ref(tab:tab-mental-battery)__) were included in the analysis (__Figure 1__).

The psychometric battery (__Supplementary Table S\@ref(tab:tab-mental-battery)__) consisted of German versions of assessment tools for 
anxiety (GAD-7: 7-item general anxiety disorder scale) [@Spitzer2006], 
depression (PHQ: patient health questionnaire, PHQ-9) [@Lowe2002; @Grafe2004], 
panic (PHQ-panic module) [@Lowe2002; @Grafe2004], 
persistent somatic symptoms (PHQ-15) [@Kroenke2002], 
resilient coping (RS13: 13-item resilience scale) [@Leppert2008], 
loss of sense of coherence (SOC-9L: Leipzig 9-item sense of coherence questionnaire) [@Schumacher2000], 
loss of quality of life (EUROHIS-QOL 8: 8-item EUROHIS project quality of life scale) [@Schmidt2006], 
post-traumatic growth (PTGI: post-traumatic growth inventory) [@Tedeschi1996] and 
post-traumatic stress disorder (PCL-5 DSM-5: PTSD checklist for DSM-5) [@Bovin2016]. 

Symptoms of anxiety were defined as GAD-7 $geq$ 10, symptoms of depression were defined as PHQ-9 $\geq$ 11 [@Manea2012], significant somatization/persistent somatic symptoms were defined as PHQ-15 $\geq$ 11 [@Kroenke2002]. 
Resilient coping classes were defined as follows: low: RS-13 0 - 65, moderate: 66 - 72, high: $\geq$ 73 [@Leppert2008]. 

Items of the EUROHIS QOL 8 tool were scores as with 1 - 5 likert scales (1: extreme concerns, no satisfaction at all, 5: no concerns/full satisfaction, ) with each item representing a single domain of quality of life (quality of life, health, energy, finances, activity, self-esteem, relationship and housing). 
The total EUROHIS QOL score was defined as the arithmetic mean of all items [@Schmidt2006]. 

Separate scores were computed for each domain of the PTGI tool (I: relations, II: possibilities, III: personal strength, IV: spiritual strength, V: life appreciation) with each item scores as 0: none, 1: very little, 2: little, 3: moderate, 4: great, 5: extremely great. 
In addition, the total PTGI score was calculated as the sum of all items [@Tedeschi1996]. 

Separate scores were calculated for domains B, C, D and E of the PCL-5 DSM-5 tool along with the total score being the sum of all items. 
Each PCL-5 DSM-5 item was scored as 0: not at all, 1: a little bit, 2: moderate, 3: quite a bit and 4: extremely. 
Participants positive for the B domain or C domain were identified by at least one item scored with 'moderate', participants positive for the D or E domain were identified by at least two item scored with 'moderate'. 
Significant PTSD symptoms where assumed in participants screened positive for at least one of the B, C, D or E PCL-5 DSM-5 domains [@Bovin2016]. 

Traumatic events prior to the sport accident were assessed with the DIA-X tool (Diagnostic Expert System) [@Maercker2005]. 
Direct personal experience or being a witness of a traumatic event specified by the DIA-X questionnaire or by an additional yes/no item ('other traumatic events') was scored as 1. 
Prior traumatic event was assumed with at least one DIA-X item scored with 1. 
Prior sport accidents, 
flashbacks during sport activity, 
confusion during sport activity, 
subjective need for psychological support, 
presence of psychological/psychiatric support/therapy post accident 
and presence of somatic health consequences after the accident 
were surveyed as single yes/no items. 
Flashbacks frequency was assessed in the following categories: none, more than one per month and more than one per year. 
Smoking was surveyed as a single yes/no question. 
Alcohol abuse was investigated with the CAGE tool with $\geq$ 2 points indicative of substantial addiction [@OBrien2008]. 
Data on hospital treatment and surgery were extracted from electronic patient's records. 
Injury severity was assessed with the abbreviated injury scale (AIS) [@Gennarelli2006]. 

Additional information on study variables and their stratification schemes are presented in __Supplementary Table S\@ref(tab:tab-analysis-vars)__.

## Consistency of psychometric tools and power analysis

Consistency of psychometric tools was assessed by factor analysis and McDonald's $\omega$ (function `omega()`, package _psych_) [@McDonald1999; @Revelle2022]. The number of latent factors for calculation of $\omega$ was identified by inspection of loadings determined by factor analysis (function `reduce_data()`, [_clustTools_](https://github.com/PiotrTymoszuk/clustTools)). 
All psychometric tools used in the study except for the stress PSS-4 scale [@Cohen1983] and the BRCS resilience tool [@Sinclair2004] exhibited good-to-excellent consistency with $\omega$ > 0.8 (__Supplementary Table S\@ref(tab:tab-consistency)__). 
The poorly performing PSS-4 and BRCS scales were excluded from the further analysis.

To find the optimal size of a training subset of the study cohort, random subsamples of the study dataset of varying sizes were investigated (`r paste(pow$sizes, collapse = ', ')` observations, 50 random draws per subsample size). 
For each random subsample, clustering tendency was assessed by Hopkins statistic (function `get_clust_tendency()`, package [_clustTools_](https://github.com/PiotrTymoszuk/clustTools)). 
For n = 200 observations, the median Hopkins statistic was `r pow$hopkins %>% filter(size == 200) %>% .$hopkins_stat %>% median %>% signif(2)` (interquartile range: `r pow$hopkins %>% filter(size == 200) %>% .$hopkins_stat %>% quantile(probs = c(0.25, 0.75)) %>% signif(2) %>% paste(collapse = ' - ')`) indicative of good clustering tendency. 
The Hopkins statistic value for this subset was comparable with the value for the entire subset (`r signif(pca$clust_tendency$data$hopkins_stat, 2)`). 
For these reasons, 2/3 of the entire dataset or n = `r count(ptsd$dataset, partition)$n[1]` was considered as the size of the training subset of the study cohort.

## Training/test subset definition

The study participants were assigned to the training and test subsets with the 2:1 size ratio (__Figure 1__). 
To this end, `r rand$part_obs %>% length` random splits of the datasets were generated. 
The subset assignment scheme was chosen with possibly small differences in accident year, age, gender, pre-existing somatic and pre-existing mental illness rates, frequencies of prior traumatic events (DIA-X) [@Maercker2005] and distribution of injury severity grades (AIS: abbreviated injury scale) [@Gennarelli2006] as investigated by $\chi^2$ and Mann-Whitney test, as appropriate (functions `chisq_test()` and `wilcox_test()`, package _rstatix_).

## Assessment of selection bias

To assess possible selection bias, demographic, socioeconomic, clinical and accident-related parameters were compared between individuals excluded due to missingness of psychometric data or denying survey participation and participants included in he analysis (__Figure 1__). 
Categorical variables were compared by $\chi^2$ test with Cramer V effect size statistic and numeric variables were compared by Mann-Whitney test with r effect size statistic (function `compare_variables()`, package [_ExDA_](https://github.com/PiotrTymoszuk/ExDA)). 
Potential differences between the training and test subset of the study cohort (__Figure 1__) were analyzed in an analogical way. 
Significant (p < 0.05) differences between the included/excluded participants are presented in __Supplementary Tables S\@ref(tab:tab-incl-excl)__.

## Semi-supervised clustering

Observations of the training subset of the study cohort were subjected to clustering in respect to the numeric psychometric scores (__Supplementary Table S\@ref(tab:tab-mental-battery)__). 
The score values were normalized and median-centered (function `center_data()`, package [_clustTools_](https://github.com/PiotrTymoszuk/clustTools)). 
For clustering, the PAM (partition around medoids) algorithm [@Schubert2019] with the cosine distance measure between observations [@Drost2018] was employed. 
The clustering object was constructed with the function `kcluster()` from the  [_clustTools_](https://github.com/PiotrTymoszuk/clustTools) package.
The choice of the clustering algorithm was motivated by its good explanatory performance measured by the fraction of explained clustering variance (ratio of between-cluster sum of squares to total sum of squares, method `var()`, [_clustTools_](https://github.com/PiotrTymoszuk/clustTools)) and superior stability in 10-fold cross-validation [@Lange2004] (cluster assignment in the folds by an inverse distance weighted 7-nearest neighbors classifier, method `cv()`, [_clustTools_](https://github.com/PiotrTymoszuk/clustTools)) in a comparison with several other clustering algorithms presented in __Supplementary Figure S\@ref(fig:fig-clust-dev)A__. 
The number of cluster was chosen based on the bend of the curve of within-cluster sum of squares and the peak of mean silhouette statistic (method `plot()`, package [_ExDA_](https://github.com/PiotrTymoszuk/ExDA)). 
By this means, three mental clusters were defined: the neutral, PTG (post-traumatic growth) and PTB (post-traumatic burden) clusters (__Supplementary Figure S\@ref(fig:fig-clust-dev)B__). 
Assignment of the training subset observations to the mental clusters was accomplished with an inverse distance weighted 7-nearest neighbor classifier. 
This semi-supervised procedure yielded clustering structures with similar fractions of explained variance in the training (V = `r signif(semi_clust$variance$variance[1], 2)`) and test subset (V = `r signif(semi_clust$variance$variance[2], 2)`). 
In addition, comparable separation between the clusters could be discerned in the training and test subsets by a visual analysis of UMAP layouts, pairwise distance heat maps (__Supplementary Figure S\@ref(fig:fig-semi-clust)__) and heat maps of normalized levels of the clustering variables (__Supplementary Figure S\@ref(fig:fig-feat-hm)__).

Differences in clustering variables, frequencies of mental disorder symptoms as well as demographic, socioeconomic, clinical and accident-related factors between the mental clusters were assessed separately in the training and test subset by $\chi^2$ test with Cramer V effect size statistic and Kruskal-Wallis test with $\eta^2$ effect size statistic for categorical and numeric variables, respectively (__Supplementary Tables S\@ref(tab:tab-clust-fct)__ and __S\@ref(tab:tab-clust-bcg)__).

## Uni- and multi-variable cluster assignment classifiers

Univariable classifiers of the mental cluster assignment for demographic, socioeconomic, clinical and accident-related parameters (__Supplementary Table S\@ref(tab:tab-mod-variables)__) were trained in the training subset of the study cohort by the one-rule (oneR) algorithm (function `OneR()`, package _OneR__) [@VonJouanne-Diedrich2017; @Holte1993]. 
The cluster assignment was subsequently predicted for the test subset observations (method `predict()`, package _OneR_). 

Two multi-parameter classifiers of the mental cluster assignment were developed in the training subset:

1. a model employing candidate early predictors of cluster assignment, i.e. demographic, socioeconomic, medical history and accident related explanatory factors

2. a model including additionally late consequences of the accident such as somatic health aftermath, flashbacks or cautious behavior during sport

The multi-parameter classifiers (__Supplementary Table S\@ref(tab:tab-mod-variables)__) were trained in the training subset with the conditional random forest algorithm [@Hothorn2006; @Strobl2007; @Hothorn2022] with n = 1000 random trees and the splitting rule corresponding to the maximum test statistic. 
In the model 1, the `mtry` parameter was set to 7, `minsplit` to 10 and `mincriterion` to 1.28 (function `cforest()` with the `cforest_control(teststat = 'max', testtype = 'Teststatistic', mtry = 7, mincriterion = qnorm(0.9), minsplit = 10, ntree = 1000)` control object, package _party_). 
In the model 2, the `mtry` parameter was set to 6, `minsplit` to 20 and `mincriterion` to 0 (function `cforest()` with the `cforest_control(teststat = 'max', testtype = 'Teststatistic', mtry = 6, mincriterion = 0, minsplit = 20, ntree = 1000)` control object, package _party_). 
The optimal parameter sets were obtained by optimization (tuning) employing the out-of-bag predictions in the training subsets (not shown). 
The cluster assignment was subsequently predicted for the test subset observations (method `predict()`, package _party_). 

Accuracy and $\kappa$ statistic for the classifiers' mental cluster assignment predictions in the training and test subsets were computed with the function `multiClassSummary()` from the package _caret_ [@Kuhn2008]. 
Conditional importance for explanatory variables expressed as accuracy loss [@Strobl2008] was obtained for the conditional random forest algorithm with the function 'varimp()` from the _party_ package.

## Data and code availability

An R data (RData) file with anonymized patient data will be made available upon request to the corresponding author. 
The study analysis pipeline is available at https://github.com/PiotrTymoszuk/mental_accident.

\newpage

# Supplementary Tables

```{r tab-analysis-vars, tab.cap = 'Variables used in the analysis pipeline. The table is available in a supplementary Excel file.'}

suppl_tables$analysis_vars[1, 1] %>% 
  mutate(`Variable name in R` = '') %>% 
  set_names(' ') %>% 
  flextable

```

\newpage

```{r tab-mental-battery, tab.cap = 'Mental health assessment battery.'}

suppl_tables$mental_battery[c(2, 3)] %>% 
  flextable %>% 
  width(1, width = 6.5, unit = 'cm') %>% 
  width(2, width = 10.5, unit = 'cm') %>% 
  theme_vanilla

```

\newpage

```{r tab-consistency, tab.cap = "Consistency of the psychometric tools used in the study measured by McDonald's omega."}

flextable::flextable(suppl_tables$consistency) %>% 
  flextable::width(1, width = 3.5, unit = 'cm') %>% 
  flextable::width(2:3, width = 3, unit = 'cm') %>% 
  footnote(1, 1, 
           value = as_paragraph('GAD-7: 7-item general anxiety disorder scale; PHQ: patient health questionnaire; EUROHIS-QOL 8: 8-item EUROHIS project quality of life scale; SOC-9L: Leipzig 9-item sense of coherence questionnaire; RS13: 13-item resilience scale; BRCS: brief resilent coping scale; PCL-5 DSM-5: PTSD checklist for DSM-5; PTGI: post-traumatic growth inventory'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  theme_vanilla

```

\newpage

```{r tab-incl-excl, tab.cap = 'Significant (p < 0.05) differences between individuals excluded from analysis and analyzed study participants. Numeric variables are presented as medians with interquartile ranges (IQR). Categorical variables are presented as percentages and counts within the complete observation set.'}

suppl_tables$incl_excl %>% 
  map_dfc(stri_replace, fixed = '\nrange', replacement = ', range') %>% 
  flextable %>% 
  flextable::width(1, width = 3.2, unit = 'cm') %>% 
  flextable::width(2:3, width = 5.5, unit = 'cm') %>% 
  flextable::width(4, width = 2.7, unit = 'cm') %>% 
  flextable::width(5, width = 2.3, unit = 'cm') %>% 
  footnote(1, 1, 
           value = as_paragraph('AIS: abbreviated injury scale; PTGI: post-traumatic growth inventory; SOC-9L: Leipzig 9-item sense of coherence scale; K: 1000 Euro; EUR: Euro.'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  footnote(1, 4:5, 
           value = as_paragraph('Numeric variables: Mann-Whitney test with r effect size statistic; categorical variables: \u03C7\u00B2 test with Cramer V effect size statistic, '), 
           part = 'header', 
           ref_symbols = 'b') %>% 
  theme_vanilla

```

\newpage

```{r tab-clust-fct, tab.cap = 'Differences in psychometric clustering factors between the mental clusters. Numeric variables are presented as medians with interquartile ranges (IQR). The table is available in a supplementary Excel file.'}

suppl_tables$clust_fct[1, 1] %>% 
  mutate(Variable = '') %>% 
  set_names(' ') %>% 
  flextable

```

\newpage

```{r tab-clust-bcg, tab.cap = 'Significant (p < 0.05) differences in demographic, socioeconomic, clinical and accident-related factors between the mental clusters. Numeric variables are presented as medians with interquartile ranges (IQR). Categorical variables are presented as percentages and counts within the complete observation set.'}

suppl_tables$clust_bcg %>% 
  flextable %>% 
  width(1, width = 1.7, unit = 'cm') %>% 
  width(2, width = 3.7, unit = 'cm') %>% 
  width(3:5, width = 3.5, unit = 'cm') %>% 
  width(6, width = 2.4, unit = 'cm') %>% 
  width(7, width = 2.2, unit = 'cm') %>% 
  merge_v(1) %>% 
  footnote(1, 2, 
           value = as_paragraph('CAGE: Cut, Annoyed, Guilty, and Eye scale; AIS: abbreviated injury score.'), 
           part = 'header', 
           ref_symbols = 'a') %>% 
  footnote(1, 6:7, 
           value = as_paragraph('Numeric variables: Kruskal-Wallis test with \u03B7\u00B2 effect size statistic. Categorical variables: \u03C7\u00B2 test with Cramer V effect size statistic.'), 
           part = 'header', 
           ref_symbols = 'b') %>% 
  theme_vanilla

```

\newpage

```{r tab-mod-variables, tab.cap = 'Sets of explanatory factors (early: available during acute medical management of the accident) used for modeling of the mental cluster assignment.'}

flextable::flextable(suppl_tables$mod_variables) %>% 
  width(1, width = 3, unit = 'cm') %>% 
  width(2, width = 12, unit = 'cm') %>% 
  theme_vanilla

```

\newpage

# Supplementary Figures

```{r fig-parts-mental-cohort, fig.width = mm_inch(suppl_figures$parts_mental_cohort$w), fig.height = mm_inch(suppl_figures$parts_mental_cohort$h), fig.cap = 'Injured body regions and detailed scoring of quality of life, post-traumatic stress disorder and post-traumatic growth in the study cohort.'}

suppl_figures$parts_mental_cohort$plot

```

__Supplementary Figure S\@ref(fig:fig-parts-mental-cohort). Injured body regions and detailed scoring of quality of life, post-traumatic stress disorder and post-traumatic growth in the study cohort.__ 

_For categorical variables, percentages of complete observations are presented as bars. Numeric variables are presented in violin plots with red diamonds denoting medians, interquartile ranges presented as red whiskers and single observations depicted as points. Quality of life scores are expressed as categorical variables and presented as percentages of participants in stack plots. The number of complete cases is displayed in the plot captions._ 
_(A) Distribution of injured body regions. (B) Scoring of the domains of the EUROHIS project 8-item quality of life scale (EUROHIS-QOL 8). (C) Scoring of the post-traumatic stress disorder (PTSD) domains with the PCL-5 DSM-5 tool and percentages of participants screened positive for the PTSD domains. (E) Scoring of the factors of the post-traumatic growth with the post-traumatic growth inventory (PTGI) tool._

\newpage

```{r fig-clust-dev, fig.width = mm_inch(suppl_figures$clust_dev$w), fig.height = mm_inch(suppl_figures$clust_dev$h), fig.cap = 'Definition of the mental clusters in the training subset of the study cohort.'}

suppl_figures$clust_dev$plot

```

__Supplementary Figure S\@ref(fig:fig-clust-dev). Definition of the mental clusters in the training subset of the study cohort.__ 

_The mental clusters were defined in respect to psychometric scoring in the training subset of the study cohort by PAM (partition around medoids) with cosine distance between the observations._

_(A) Comparison of explanatory performance and stability of various clustering algorithms in the training subset. The explanatory performance was measured as a fraction of explained clustering variance (ratio of between-cluster sum of squares to total sum of squares). The stability was assessed by a rate of correct cluster assignment in 10-fold cross-validation (CV) with cluster assignment in the folds by an inverse distance weighted 7-nearest neighbors classifier. Note the superior stability of the PAM/cosine distance algorithm._

_(B) Determination of the cluster number by the bend of the within-cluster sum of squares curve and the peak mean silhouette statistic._

\newpage

```{r fig-semi-clust, fig.width = mm_inch(suppl_figures$semi_clust$w), fig.height = mm_inch(suppl_figures$semi_clust$h), fig.cap = 'Semi-supervised clustering.'}

suppl_figures$semi_clust$plot

```

__Supplementary Figure S\@ref(fig:fig-semi-clust). Semi-supervised clustering.__ 

_The mental clusters were defined in respect to psychometric scoring in the training subset of the study cohort by PAM (partition around medoids) with cosine distance between the observations. Assignment of the test subset observations to the mental clusters was done with the inverse distance weighted 7-nearest neighbors classifier. By this procedure, three mental clusters were identified: neutral, PTG (post-traumatic growth) and PTB (post-traumatic burden). Numbers of observations in the mental clusters are shown in the plot legend in (A)._

_(A) Observations in the training and test subsets of the study cohorts were subjected to two-dimensional UMAP (uniform manifold approximation and projection) in respect to the psychometric scores. UMAP layouts are shown in scatter plots. Points represent single samples. Point color codes for the cluster assignment._

_(B) Pairwise cosine distances between observations in the mental clusters of the training and test subsets presented in heat maps._

\newpage

```{r fig-feat-hm, fig.width = mm_inch(suppl_figures$feat_hm$w), fig.height = mm_inch(suppl_figures$feat_hm$h), fig.cap = 'Levels of psychometric clustering scores in the mental clusters.'}

suppl_figures$feat_hm$plot

```

__Supplementary Figure S\@ref(fig:fig-feat-hm). Levels of psychometric clustering scores in the mental clusters.__

_Levels of psychometric scores used in clustering in the mental clusters. Normalized, median-centered score values (Z scores) are presented as heat maps. Numbers of observations in the clusters are displayed in the plot captions. PSS4: 4-item perceived stress scale; GAD-7: 7-item general anxiety disorder scale; PHQ: patient health questionnaire; EUROHIS-QOL 8: 8-item EUROHIS project quality of life scale; SOC-9L: Leipzig 9-item sense of coherence questionnaire; RS13: 13-item resilience scale; PCL-5 DSM-5: PTSD checklist for DSM-5; PTGI: post-traumatic growth inventory; PTSD: post-traumatic stress disorder._

\newpage

```{r fig-demo, fig.width = mm_inch(suppl_figures$demo$w), fig.height = mm_inch(suppl_figures$demo$h), fig.cap = 'Age, education, household income, prior accidents and traumatic events in the mental clusters.'}

suppl_figures$demo$plot

```

__Supplementary Figure S\@ref(fig:fig-demo). Age, education, household income, prior accidents and traumatic events in the mental clusters.__ 

_Distribution of age classes (A, young: < 30, middle: 30 - 65, elderly > 65 years), education grades (B), frequencies of prior sport accidents (D) and prior traumatic events (E, measured by the DIA-X tool) in the mental clusters. Statistical significance was determined by $\chi^2$ test with Cramer V effect size statistic. Percentages in the mental clusters in the training and test subset of the study cohort are presented in stack plots. Effect sizes and p-values are displayed in the plot captions. Numbers of observations in the clusters are presented in the X axes._

\newpage

```{r fig-accident, fig.width = mm_inch(suppl_figures$accident$w), fig.height = mm_inch(suppl_figures$accident$h), fig.cap = 'Accident sport type and accident rescue in the mental clusters.'}

suppl_figures$accident$plot

```

__Supplementary Figure S\@ref(fig:fig-accident). Accident sport type and accident rescue in the mental clusters.__ 

_Distribution of sport types (A) and rescue modes (B, C) in the mental clusters. Statistical significance was determined by $\chi^2$ test with Cramer V effect size statistic. Percentages in the mental clusters in the training and test subset of the study cohort are presented in stack plots. Effect sizes and p-values are displayed in the plot captions. Numbers of observations in the clusters are presented in the X axes._

\newpage

```{r fig-oneR, fig.width = mm_inch(suppl_figures$oneR$w), fig.height = mm_inch(suppl_figures$oneR$h), fig.cap = 'Prediction of the mental cluster assignment by single demographic, socioeconomic, clinical and accident-related factors available during acute medical management of the accident.'}

suppl_figures$oneR$plot

```

__Supplementary Figure S\@ref(fig:fig-oneR). Prediction of the mental cluster assignment by single demographic, socioeconomic, clinical and accident-related factors available during acute medical management of the accident.__ 

_Univariable classifiers of the mental cluster assignment for demographic, socioeconomic, clinical and accident-related parameters available during acute medical management of the mountain sport accident were trained in the training subset of the study cohort by the one-rule (oneR) algorithm. The cluster assignment was subsequently predicted for the test subset observations. Accuracy and $\kappa$ of the classifiers with any predictive value ($\kappa$ > 0 in both subsets) are shown in bar plots._

\newpage

```{r fig-crf, fig.width = mm_inch(suppl_figures$crf$w), fig.height = mm_inch(suppl_figures$crf$h), fig.cap = 'Assignment of accident victims to the mental clusters based on demographic, socioeconomic, clinical, accident- and accident consequence-related factors by the random forest algorithm.'}

suppl_figures$crf$plot

```

__Supplementary Figure S\@ref(fig:fig-crf). Assignment of accident victims to the mental clusters based on demographic, socioeconomic, clinical, accident- and accident consequence-related factors by the random forest algorithm.__ 

_A conditional random forest classifier for the mental cluster assignment based on demographic, socioeconomic, clinical and accident- and accident consequence-related factors was trained in the training subset of the study cohort._

_(A) Prediction accuracy of the classifier in the training and test subset of the study cohort presented in a heat map plot of the confusion matrices. Color codes for number of cases. The overall prediction accuracy, $\kappa$ and observation numbers are displayed in the plot caption. Prediction accuracy for particular clusters is shown in the X axis._

_(B) Conditional importance of the explanatory variables for prediction of the mental cluster assignment expressed as accuracy loss ($\Delta$ accuracy)._

\newpage

# References